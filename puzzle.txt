You are given three little felt drawstring bags. In each of these bags, you have 10 marbles. 10 marbles total, in each bag. 

One bag is filled with 10 black marbles. 

One bag is filled with 10 white marbles.

And the last bag is filled with half and half, 5 black and 5 white. 

Each bag has a little label on it. However, the labels are all incorrect.

So, you are allowed to reach your hand into a bag, but you are not allowed to look at the colors of the marbles in the bags. You are allowed to reach in and remove one marble from a bag, and then you can look at that marble. But then you have to return that marble back to its bag without looking at the rest of them. You can only have one marble out of a bag at a time. So, you take one out, look at it, then return it. You are then allowed to pull a marble from another bag, look at it, and then return it. And so on and so on. 

So, here is the question. 

How many times do you have to do this to identify each bag? In other words, how many peeks do you get of one marble from one bag at a time, before you can clearly identify which bag is the all black bag, which is the all white and which is the mixed bag?

(Credit to Car Talk)